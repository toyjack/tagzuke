webpackJsonp([1],{0:function(t,e){},1:function(t,e){},2:function(t,e){},"7zck":function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("7+uW"),s=a("3EgV"),r=a.n(s),i=a("NYxO"),o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-navigation-drawer",{attrs:{fixed:"",app:""},model:{value:t.ifShowNavBar,callback:function(e){t.ifShowNavBar=e},expression:"ifShowNavBar"}},[a("v-toolbar",{attrs:{flat:""}},[a("v-list",[a("v-list-tile",[a("v-list-tile-title",{staticClass:"title"},[t._v("\n            Menu\n          ")])],1)],1)],1),t._v(" "),a("v-divider"),t._v(" "),a("v-list",{staticClass:"pt-0",attrs:{dense:""}},t._l(t.items,function(e){return a("v-list-tile",{key:e.title,on:{click:function(a){t.$router.push(e.path)}}},[a("v-list-tile-action",[a("v-icon",[t._v(t._s(e.icon))])],1),t._v(" "),a("v-list-tile-content",[a("v-list-tile-title",[t._v(t._s(e.title))])],1)],1)}))],1)},staticRenderFns:[]},l={name:"App",components:{NavBar:a("VU/8")({props:["ifShow"],computed:{ifShowNavBar:{get:function(){return this.$store.state.ifShowNavBar},set:function(){}}},data:function(){return{items:[{title:"ファイルを開く",icon:"dashboard",path:"/"},{title:"設定",icon:"settings",path:"/settings"},{title:"表示",icon:"picture_in_picture",path:"/display"},{title:"アバウト",icon:"info",path:"/about"}]}},mounted:function(){},methods:{}},o,!1,null,null,null).exports},data:function(){return{}},computed:{ifShowNavBar:{get:function(){return this.$store.state.ifShowNavBar},set:function(){}}},mounted:function(){},methods:{toggleNavBar:function(){this.$store.commit("toggleNavBar")}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("nav-bar",{attrs:{title:"test"}}),t._v(" "),a("v-toolbar",{attrs:{fixed:"",app:""}},[a("v-toolbar-side-icon",{on:{click:function(e){e.stopPropagation(),t.toggleNavBar(e)}}}),t._v(" "),a("v-toolbar-title",[t._v(t._s(t.$route.name))])],1),t._v(" "),a("v-content",[a("router-view")],1),t._v(" "),a("v-footer",{attrs:{app:""}})],1)},staticRenderFns:[]};var c=a("VU/8")(l,u,!1,function(t){a("dRYz")},null,null).exports,d=a("/ocq"),v=a("uXZL"),f=a.n(v),h={name:"Home",data:function(){return{wb:null,sheetNames:[],readed:!1}},methods:{onFileChange:function(t){var e=t.target.files[0],a=new FileReader,n=this;a.onload=function(t){var e=t.target.result;n.wb=f.a.read(e,{type:"binary"}),n.sheetNames=n.wb.SheetNames,n.$store.commit("updateWorkbookData",n.wb),n.readed=!0,n.$router.push("/settings")},a.readAsBinaryString(e)}}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:"","fill-height":""}},[t.readed?t._e():a("v-layout",{attrs:{"justify-center":"","align-center":""}},[a("a",[a("h2",{on:{click:function(e){t.$refs.fileInput.click()}}},[t._v("ファイルを開く")])]),t._v(" "),a("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:t.onFileChange}}),t._v(" "),a("v-btn",{attrs:{icon:""},on:{click:function(e){t.$refs.fileInput.click()}}},[a("v-icon",[t._v("insert_drive_file")])],1)],1)],1)},staticRenderFns:[]},m=a("VU/8")(h,p,!1,null,null,null).exports,_={name:"Settings",data:function(){return{sheet:null,filedNames:[],selectedSheetName:null,selectedIDFiledName:null,selectedEntryFiledName:null,selectedDefFieldName:null,ifShowSelectSheet:!0,ifShowSelectField:!1,canRender:!1,skipFirstLine:!0,separator:"　",tags:[]}},computed:{workbookData:function(){return!!this.$store.state.workbookData&&this.$store.state.workbookData},sheetNames:function(){return this.workbookData?this.$store.state.workbookData.SheetNames:[]}},watch:{},mounted:function(){},methods:{onSheetChange:function(){this.ifShowSelectField=!0;var t=this.$store.state.workbookData.Sheets[this.selectedSheetName];this.$store.commit("updateWorkingSheet",this.selectedSheetName),this.sheet=f.a.utils.sheet_to_json(t,{header:1}),this.filedNames=this.sheet[0]},renderTable:function(){var t=this.filedNames.indexOf(this.selectedIDFiledName);this.$store.commit("updateIndexID",t);var e=this.filedNames.indexOf(this.selectedEntryFiledName);this.$store.commit("updateIndexEntry",e);var a=this.filedNames.indexOf(this.selectedDefFieldName);this.$store.commit("updateIndexDef",a);for(var n=[],s=0;s<this.sheet.length;s++){var r=this.sheet[s],i=r[t],o=r[e],l=r[a]||"";n.push({id:i,entry:o,def:l})}this.skipFirstLine&&n.shift(),this.$store.commit("updateSeparator",this.separator),this.$store.commit("updateWorkData",n),this.$router.push("/display")}}},x={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-text",[a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs4:""}},[a("v-subheader",[t._v("シート：")])],1),t._v(" "),a("v-flex",{attrs:{xs8:""}},[t.ifShowSelectSheet?a("v-select",{attrs:{items:t.sheetNames,label:"選択","single-line":"",bottom:""},on:{input:t.onSheetChange},model:{value:t.selectedSheetName,callback:function(e){t.selectedSheetName=e},expression:"selectedSheetName"}}):t._e()],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs4:""}},[a("v-subheader",[t._v("IDフィールド：")])],1),t._v(" "),a("v-flex",{attrs:{xs8:""}},[t.ifShowSelectField?a("v-select",{attrs:{items:t.filedNames,label:"選択","single-line":"",bottom:""},model:{value:t.selectedIDFiledName,callback:function(e){t.selectedIDFiledName=e},expression:"selectedIDFiledName"}}):t._e()],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs4:""}},[a("v-subheader",[t._v("掲出字フィールド：")])],1),t._v(" "),a("v-flex",{attrs:{xs8:""}},[t.ifShowSelectField?a("v-select",{attrs:{items:t.filedNames,label:"選択","single-line":"",bottom:""},model:{value:t.selectedEntryFiledName,callback:function(e){t.selectedEntryFiledName=e},expression:"selectedEntryFiledName"}}):t._e()],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs4:""}},[a("v-subheader",[t._v("注文フィールド：")])],1),t._v(" "),a("v-flex",{attrs:{xs8:""}},[t.ifShowSelectField?a("v-select",{attrs:{items:t.filedNames,label:"選択","single-line":"",bottom:""},model:{value:t.selectedDefFieldName,callback:function(e){t.selectedDefFieldName=e},expression:"selectedDefFieldName"}}):t._e()],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs4:""}},[a("v-subheader",[t._v("注文要素の区切り文字：")])],1),t._v(" "),a("v-flex",{attrs:{xs8:""}},[a("v-text-field",{attrs:{name:"separator",label:"デフォルトは全角スペースです",id:"separator"},model:{value:t.separator,callback:function(e){t.separator=e},expression:"separator"}})],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-checkbox",{attrs:{label:"`最初の行をスキップ`"},model:{value:t.skipFirstLine,callback:function(e){t.skipFirstLine=e},expression:"skipFirstLine"}})],1)],1),t._v(" "),t.tags?a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},t._l(t.tags,function(e){return a("span",{key:e},[t._v("\n            "+t._s(e)+"\n          ")])}))],1):t._e(),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs4:""}},[t._v("\n          検出したタグ：\n        ")]),t._v(" "),a("v-flex",{attrs:{xs8:""}},[a("div",{staticClass:"text-xs-center"},[a("v-btn",{attrs:{round:"",color:"primary",dark:""},on:{click:function(e){e.stopPropagation(),t.renderTable(e)}}},[t._v("開く")])],1)])],1)],1)],1)],1)},staticRenderFns:[]},k=a("VU/8")(_,x,!1,null,null,null).exports,w={render:function(){var t=this.$createElement;return(this._self._c||t)("h2",[this._v("About")])},staticRenderFns:[]},b=a("VU/8")(null,w,!1,null,null,null).exports,g=a("lHA8"),y=a.n(g),S=a("c/Tr"),N=a.n(S),F={data:function(){return{}},mounted:function(){},computed:{separator:function(){return this.$store.state.separator},items:function(){for(var t=this.$store.state.workData,e=[],a=[],n=0;n<t.length;n++){for(var s=t[n],r=(s.def||"").split(this.separator),i=[],o=0;o<r.length;o++){var l=r[o],u=/(<([^>]+)>)/gi,c=l.match(u),d=l.replace(u,"");c?(e.push(c[0]),i.push({type:c[0],text:d})):i.push({type:"",text:d})}var v={id:s.id,entry:s.entry,def:i};a.push(v)}return e=N()(new y.a(e)),this.$store.commit("updateTags",e),a},tagStyle:function(){return this.$store.state.tagStyle},tags:function(){return this.$store.state.tags}},methods:{edit:function(t,e,a){this.items[t].def[e].type=a,console.log(this.items[t].def[e]),this.$forceUpdate()},save:function(){for(var t=[],e=0;e<this.items.length;e++){var a=this.items[e],n="";if(Array.isArray(a.def)){for(var s=0;s<a.def.length;s++){var r=a.def[s],i=r.type,o=r.text,l=r.type.replace(/</,"</");n=""===n?i+o+l:n+"　"+i+o+l}a.def=n}t.push({id:a.id,entry:a.entry,def:n})}var u=f.a.utils.json_to_sheet(t,{header:["id","def","entry"]}),c={SheetNames:[],Sheets:{},Props:{Title:"tagzuke!",Author:"Guanwei Liu"}};f.a.utils.book_append_sheet(c,u,"シート１"),f.a.writeFile(c,"out.xlsb")}}},D={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs8:""}},t._l(t.items,function(e,n){return a("v-flex",{key:n,attrs:{xs12:"",row:""}},[a("v-card",[a("v-card-title",[a("h2",[t._v(t._s(e.entry))])]),t._v(" "),t._l(e.def,function(e,s){return a("v-menu",{key:s,attrs:{"offset-y":"",absolute:""}},[t._v("\n           "),a("span",{class:t.tagStyle[e.type],attrs:{slot:"activator"},slot:"activator"},[t._v("\n            "+t._s(e.text)+"\n          ")]),t._v(" "),a("v-list",t._l(t.tags,function(e){return a("v-list-tile",{key:e,on:{click:function(a){t.edit(n,s,e)}}},[a("v-list-tile-title",[t._v(t._s(e))])],1)}))],1)}),t._v(" "),a("v-divider")],2)],1)})),t._v(" "),a("v-flex",{attrs:{xs4:""}},[a("h2",[t._v("タグ：")]),t._v(" "),t._l(t.tags,function(e){return a("span",{key:e},[t._v("\n      "+t._s(e)+":"+t._s(t.tagStyle[e])+"\n      "),a("br")])}),t._v(" "),a("v-flex",{attrs:{row:""}},[a("v-btn",{on:{click:function(e){e.stopPropagation(),t.save(e)}}},[t._v("保存")])],1)],2)],1)},staticRenderFns:[]},$=a("VU/8")(F,D,!1,null,null,null).exports;n.a.use(d.a);var I=new d.a({mode:"history",routes:[{path:"/",name:"ファイルを開く",component:m},{path:"/settings",name:"設定",component:k},{path:"/about",name:"アバウト",component:b},{path:"/display",name:"表示",component:$}]});n.a.use(i.a);var B=new i.a.Store({state:{ifShowNavBar:!1,workbookData:null,workData:null,workbookState:{sheet:"",indexID:"",indexEntry:"",indexDef:"",separator:"　"},tags:[],tagStyle:{"<jion>":"red","<jitai>":"blue","<kanbun>":"green","<wakun>":"orange"}},mutations:{toggleNavBar:function(t){t.ifShowNavBar=!t.ifShowNavBar},updateWorkbookData:function(t,e){t.workbookData=e},updateWorkData:function(t,e){t.workData=e},updateTags:function(t,e){t.tags=e},updateTagStyle:function(t,e){t.tagStyle=e},updateWorkingSheet:function(t,e){t.workbookState.sheet=e},updateIndexID:function(t,e){t.workbookState.indexID=e},updateIndexEntry:function(t,e){t.workbookState.indexEntry=e},updateIndexDef:function(t,e){t.workbookState.indexDef=e},updateSeparator:function(t,e){t.separator=e}}});a("7zck");n.a.use(i.a),n.a.use(r.a),n.a.config.productionTip=!1;new n.a({el:"#app",store:B,router:I,components:{App:c},template:"<App/>"})},dRYz:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.8d37f281c5af171c5559.js.map